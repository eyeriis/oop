<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baghdad Route Finder</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="styles.css" />
</head>
<body>
<button class="sidebar-toggle" id="sidebarToggle">‚óÄ</button>
<div class="container">
    <div class="sidebar" id="sidebar">
        <div class="header">
            <h1>üó∫Ô∏è Baghdad Routes</h1>
            <div class="dark-toggle" id="darkToggle">üåô</div>
        </div>
        
        <div class="tabs">
            <button class="tab-btn active" data-tab="route">Route</button>
            <button class="tab-btn" data-tab="directions">Directions</button>
            <button class="tab-btn" data-tab="history">History</button>
            <button class="tab-btn" data-tab="favorites">Favorites</button>
            <button class="tab-btn" data-tab="tools">Tools</button>
            <button class="tab-btn" id="oopTabBtn">OOP</button>
        </div>
        
        <!-- ROUTE TAB -->
        <div id="route" class="tab-content active">
            <form id="routeForm">
                <div class="form-group">
                    <label>Origin</label>
                    <div class="input-row">
                        <div class="autocomplete-container">
                            <input type="text" id="origin" placeholder="Address or lat,lon" autocomplete="off">
                            <div class="autocomplete-dropdown" id="originDropdown"></div>
                        </div>
                        <button type="button" id="myLocationBtn" class="small-btn gps-btn" title="Use GPS">‚¶ø</button>
                        <button type="button" id="pickOriginBtn" class="small-btn" title="Pick on map" style="background:#16a34a;">‚óâ</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Destination</label>
                    <div class="input-row">
                        <div class="autocomplete-container">
                            <input type="text" id="destination" placeholder="Address or lat,lon" autocomplete="off">
                            <div class="autocomplete-dropdown" id="destDropdown"></div>
                        </div>
                        <button type="button" id="pickDestBtn" class="small-btn" title="Pick on map" style="background:#dc2626;">‚óé</button>
                    </div>
                </div>
                <div id="waypointsContainer"></div>
                <button type="button" id="addWaypointBtn" class="small-btn" style="margin-bottom: 10px;">+ Add Stop</button>
                <button type="submit" id="findBtn" style="width: 100%;">üöó Find Route</button>
                <button type="button" id="clearBtn" class="small-btn danger-btn" style="width: 100%; margin-top: 8px;">üóëÔ∏è Clear</button>
            </form>
            <div id="loading" style="display: none; text-align: center; margin: 15px 0;"><span class="spinner"></span> Finding route...</div>
            <div class="error" id="error"></div>
            <div class="success" id="success"></div>
            <div class="stats" id="routeStats" style="display: none;">
                <div class="stat"><div class="stat-value" id="distance">0</div><div class="stat-label">Distance (km)</div></div>
                <div class="stat"><div class="stat-value" id="time">0</div><div class="stat-label">Time (min)</div></div>
            </div>
            <div class="route-alternatives" id="routeAlternatives">
                <label>Alternative Routes</label>
                <div id="altRoutesList"></div>
            </div>
        </div>
        
        <!-- DIRECTIONS TAB -->
        <div id="directions" class="tab-content">
            <h3>üìã Turn-by-Turn Directions</h3>
            <div id="directionsList"><p style="color: #888; font-size: 12px;">Find a route first</p></div>
        </div>
        
        <!-- HISTORY TAB -->
        <div id="history" class="tab-content">
            <h3>‚è±Ô∏è Recent Routes</h3>
            <div id="historyList"><p style="color: #888; font-size: 12px;">No routes yet</p></div>
            <button id="clearHistoryBtn" class="small-btn danger-btn" style="margin-top: 10px;">üóëÔ∏è Clear History</button>
        </div>
        
        <!-- FAVORITES TAB -->
        <div id="favorites" class="tab-content">
            <h3>‚≠ê Save a Location</h3>
            <div class="form-group"><input type="text" id="favName" placeholder="Name (Home, Work)"></div>
            <div class="form-group">
                <div class="input-row">
                    <input type="text" id="favCoords" placeholder="Coordinates (lat,lon)">
                    <button type="button" id="favGpsBtn" class="small-btn gps-btn">üìç GPS</button>
                </div>
            </div>
            <button id="saveFavBtn" style="width: 100%;">üíæ Save Favorite</button>
            <hr>
            <h3>üìå Saved Places</h3>
            <div id="favList"><p style="color: #888; font-size: 12px;">No favorites</p></div>
        </div>
        
        <!-- TOOLS TAB -->
        <div id="tools" class="tab-content">
            <h3>üö¶ Traffic Layer</h3>
            <div class="traffic-toggle">
                <input type="checkbox" id="trafficToggle">
                <label for="trafficToggle" style="text-transform: none; font-size: 13px; margin: 0;">Show simulated traffic conditions</label>
            </div>
            <div class="traffic-legend" id="trafficLegend" style="display: none;">
                <div class="traffic-legend-item"><div class="traffic-dot green"></div>Light</div>
                <div class="traffic-legend-item"><div class="traffic-dot yellow"></div>Moderate</div>
                <div class="traffic-legend-item"><div class="traffic-dot red"></div>Heavy</div>
            </div>
            <hr>
            <h3>üìç Points of Interest</h3>
            <div class="poi-section">
                <div class="poi-toggle">
                    <input type="checkbox" id="poiToggle">
                    <label for="poiToggle" style="text-transform: none; font-size: 13px; margin: 0;">Show POIs along route</label>
                </div>
                <div class="poi-categories" id="poiCategories" style="display: none;">
                    <div class="poi-chip active" data-category="fuel">‚õΩ Fuel</div>
                    <div class="poi-chip active" data-category="restaurant">üçΩÔ∏è Food</div>
                    <div class="poi-chip" data-category="hospital">üè• Hospital</div>
                    <div class="poi-chip" data-category="atm">üèß ATM</div>
                    <div class="poi-chip" data-category="parking">üÖøÔ∏è Parking</div>
                </div>
            </div>
            <hr>
            <h3>üì§ Export Route</h3>
            <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                <button id="exportGeoJSON" class="small-btn">GeoJSON</button>
                <button id="exportGPX" class="small-btn">GPX</button>
                <button id="exportCSV" class="small-btn">CSV</button>
            </div>
            <hr>
            <h3>üé® Map Style</h3>
            <select id="mapStyle">
                <option value="osm">OpenStreetMap</option>
                <option value="satellite">Satellite</option>
                <option value="dark">Dark</option>
            </select>
            <hr>
            <h3>üîó Share Route</h3>
            <button id="shareBtn" class="small-btn">üìã Copy Link</button>
            <div id="shareLink" style="font-size: 10px; word-break: break-all; margin-top: 8px; color: #666;"></div>
        </div>
    </div>
    
    <div class="map-container">
        <div id="map"></div>
        
        <!-- OOP PRESENTATION OVERLAY -->
        <div class="oop-overlay" id="oopOverlay">
            <div class="oop-close" id="oopClose">√ó</div>
            
            <div class="oop-slider" id="oopSlider">
                <!-- SLIDE 1: INTRO -->
                <div class="oop-slide">
                    <p style="font-size: 13px; color: #9ec4db; margin-bottom: 12px; letter-spacing: 3px; font-weight: 500; font-family: 'JetBrains Mono', monospace;">01</p>
                    <h2>Object-Oriented Programming</h2>
                    <p>OOP organizes code into Objects ‚Äî containers with data (properties) and actions (methods).</p>
                    <div class="code-box">
                        <span class="comment">// An object bundles data + behavior</span><br>
                        <span class="keyword">class</span> <span class="class-name">Route</span> {<br>
                        &nbsp;&nbsp;<span class="property">distance</span> = <span class="string">0</span>;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// Data</span><br>
                        &nbsp;&nbsp;<span class="method">calculate</span>() { ... }&nbsp;&nbsp;<span class="comment">// Behavior</span><br>
                        }
                    </div>
                    <p class="note-box">‚Üí This app uses OOP to organize routing, locations, and history.</p>
                </div>
                
                <!-- SLIDE 2: CLASSES -->
                <div class="oop-slide">
                    <p style="font-size: 13px; color: #9ec4db; margin-bottom: 12px; letter-spacing: 3px; font-weight: 500; font-family: 'JetBrains Mono', monospace;">02</p>
                    <h2>Classes in This App</h2>
                    <div class="class-diagram">
                        <div class="class-card">
                            <h4>Route</h4>
                            <div class="label">Properties</div>
                            <div class="props">coordinates[], distance, time</div>
                            <div class="label">Methods</div>
                            <div class="methods">calculate(), export(), getDirections()</div>
                        </div>
                        <div class="class-card">
                            <h4>Location</h4>
                            <div class="label">Properties</div>
                            <div class="props">address, lat, lon, accuracy</div>
                            <div class="label">Methods</div>
                            <div class="methods">geocode(), validate(), toCoords()</div>
                        </div>
                        <div class="class-card">
                            <h4>Favorite</h4>
                            <div class="label">Properties</div>
                            <div class="props">name, lat, lon, category</div>
                            <div class="label">Methods</div>
                            <div class="methods">save(), delete(), useAsOrigin()</div>
                        </div>
                        <div class="class-card">
                            <h4>History</h4>
                            <div class="label">Properties</div>
                            <div class="props">routes[], maxSize</div>
                            <div class="label">Methods</div>
                            <div class="methods">add(), getAll(), clear()</div>
                        </div>
                    </div>
                </div>
                
                <!-- SLIDE 3: 4 PILLARS -->
                <div class="oop-slide">
                    <p style="font-size: 13px; color: #9ec4db; margin-bottom: 12px; letter-spacing: 3px; font-weight: 500; font-family: 'JetBrains Mono', monospace;">03</p>
                    <h2>The 4 Pillars of OOP</h2>
                    <div class="oop-pillar-box">
                        <div class="oop-pillar">
                            <h4>1. Encapsulation</h4>
                            <p>Hide internal data, expose only necessary methods.</p>
                        </div>
                        <div class="oop-pillar">
                            <h4>2. Inheritance</h4>
                            <p>Child classes inherit from parents to reuse code.</p>
                        </div>
                        <div class="oop-pillar">
                            <h4>3. Polymorphism</h4>
                            <p>Same method name, different implementations.</p>
                        </div>
                        <div class="oop-pillar">
                            <h4>4. Abstraction</h4>
                            <p>Hide complexity behind simple interfaces.</p>
                        </div>
                    </div>
                </div>
                
                <!-- SLIDE 4: ENCAPSULATION -->
                <div class="oop-slide">
                    <p style="font-size: 13px; color: #9ec4db; margin-bottom: 12px; letter-spacing: 3px; font-weight: 500; font-family: 'JetBrains Mono', monospace;">04</p>
                    <h2>Encapsulation</h2>
                    <p>Each class hides its internal data and exposes only what's necessary.</p>
                    <div class="code-box">
                        <span class="keyword">class</span> <span class="class-name">Route</span> {<br>
                        &nbsp;&nbsp;<span class="keyword">private</span> <span class="property">_coordinates</span> = [];<br>
                        &nbsp;&nbsp;<span class="keyword">private</span> <span class="property">_distance</span> = <span class="string">0</span>;<br><br>
                        &nbsp;&nbsp;<span class="comment">// Public method hides complexity</span><br>
                        &nbsp;&nbsp;<span class="method">export</span>(<span class="property">format</span>) {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span> (format === <span class="string">'geojson'</span>) <span class="keyword">return</span> <span class="keyword">this</span>.<span class="method">_toGeoJSON</span>();<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span> (format === <span class="string">'gpx'</span>) <span class="keyword">return</span> <span class="keyword">this</span>.<span class="method">_toGPX</span>();<br>
                        &nbsp;&nbsp;}<br>
                        }
                    </div>
                    <p class="note-box">‚Üí User calls route.export('gpx') without knowing internal logic</p>
                </div>
                
                <!-- SLIDE 5: INHERITANCE -->
                <div class="oop-slide">
                    <p style="font-size: 13px; color: #9ec4db; margin-bottom: 12px; letter-spacing: 3px; font-weight: 500; font-family: 'JetBrains Mono', monospace;">05</p>
                    <h2>Inheritance</h2>
                    <p>Child classes inherit properties and methods from parent classes.</p>
                    <div class="code-box">
                        <span class="keyword">class</span> <span class="class-name">Location</span> {<br>
                        &nbsp;&nbsp;<span class="property">lat</span>; <span class="property">lon</span>;<br>
                        &nbsp;&nbsp;<span class="method">geocode</span>() { <span class="comment">/* convert address */</span> }<br>
                        }<br><br>
                        <span class="keyword">class</span> <span class="class-name">Favorite</span> <span class="keyword">extends</span> <span class="class-name">Location</span> {<br>
                        &nbsp;&nbsp;<span class="property">name</span>; <span class="comment">// Additional property</span><br>
                        &nbsp;&nbsp;<span class="method">save</span>() { <span class="comment">/* store in localStorage */</span> }<br>
                        }<br><br>
                        <span class="comment">// Favorite inherits lat, lon, geocode() from Location!</span>
                    </div>
                    <p class="note-box">‚Üí Favorite reuses Location's code without rewriting it</p>
                </div>
                
                <!-- SLIDE 6: POLYMORPHISM -->
                <div class="oop-slide">
                    <p style="font-size: 13px; color: #9ec4db; margin-bottom: 12px; letter-spacing: 3px; font-weight: 500; font-family: 'JetBrains Mono', monospace;">06</p>
                    <h2>Polymorphism</h2>
                    <p>Same method name, different behavior based on context.</p>
                    <div class="code-box">
                        <span class="keyword">class</span> <span class="class-name">Route</span> {<br>
                        &nbsp;&nbsp;<span class="method">export</span>(<span class="property">format</span>) {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">switch</span>(format) {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">case</span> <span class="string">'geojson'</span>: <span class="keyword">return</span> { <span class="property">type</span>: <span class="string">'Feature'</span>... };<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">case</span> <span class="string">'gpx'</span>: <span class="keyword">return</span> <span class="string">'&lt;gpx&gt;...&lt;/gpx&gt;'</span>;<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">case</span> <span class="string">'csv'</span>: <span class="keyword">return</span> <span class="string">'lat,lon\\n...'</span>;<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                        &nbsp;&nbsp;}<br>
                        }
                    </div>
                    <p class="note-box">‚Üí One export() method, three different outputs</p>
                </div>
                
                <!-- SLIDE 7: ABSTRACTION -->
                <div class="oop-slide">
                    <p style="font-size: 13px; color: #9ec4db; margin-bottom: 12px; letter-spacing: 3px; font-weight: 500; font-family: 'JetBrains Mono', monospace;">07</p>
                    <h2>Abstraction</h2>
                    <p>Hide complex implementation behind simple interfaces.</p>
                    <div class="code-box">
                        <span class="comment">// What you see (simple):</span><br>
                        <span class="keyword">await</span> <span class="method">findRoute</span>(<span class="string">"Tahrir Square"</span>, <span class="string">"Airport"</span>);<br><br>
                        <span class="comment">// What happens inside (complex):</span><br>
                        <span class="comment">// 1. Geocode addresses to lat/lon</span><br>
                        <span class="comment">// 2. Call OSRM routing API</span><br>
                        <span class="comment">// 3. Parse GeoJSON response</span><br>
                        <span class="comment">// 4. Calculate distance/time</span><br>
                        <span class="comment">// 5. Generate turn-by-turn</span><br>
                        <span class="comment">// 6. Update map display</span>
                    </div>
                    <p class="note-box">‚Üí You click "Find Route" ‚Äî all complexity is hidden</p>
                </div>
                
                <!-- SLIDE 8: DATA FLOW -->
                <div class="oop-slide">
                    <p style="font-size: 13px; color: #9ec4db; margin-bottom: 12px; letter-spacing: 3px; font-weight: 500; font-family: 'JetBrains Mono', monospace;">08</p>
                    <h2>Data Flow in This App</h2>
                    <div class="flow-diagram">
                        <div class="flow-step input">userInput</div>
                        <span class="flow-arrow">‚Üí</span>
                        <div class="flow-step method">Location.geocode()</div>
                        <span class="flow-arrow">‚Üí</span>
                        <div class="flow-step method">Route.calculate()</div>
                        <span class="flow-arrow">‚Üí</span>
                        <div class="flow-step method">History.add()</div>
                        <span class="flow-arrow">‚Üí</span>
                        <div class="flow-step output">render()</div>
                    </div>
                    <div class="code-box" style="margin-top: 28px; max-width: 600px;">
                        <span class="comment">// Each class handles one step</span><br>
                        <span class="keyword">const</span> <span class="property">coords</span> = <span class="keyword">await</span> Location.<span class="method">geocode</span>(input);<br>
                        <span class="keyword">const</span> <span class="property">route</span> = <span class="keyword">await</span> Route.<span class="method">calculate</span>(coords);<br>
                        History.<span class="method">add</span>(route);<br>
                        Map.<span class="method">render</span>(route);
                    </div>
                </div>
                
                <!-- SLIDE 9: WHY OOP -->
                <div class="oop-slide">
                    <p style="font-size: 13px; color: #9ec4db; margin-bottom: 12px; letter-spacing: 3px; font-weight: 500; font-family: 'JetBrains Mono', monospace;">09</p>
                    <h2>Why OOP Matters</h2>
                    <div class="benefits-box">
                        <div class="benefit-row">
                            <span class="benefit-key">reusable:</span>
                            <span class="benefit-val">true</span>
                            <span class="benefit-comment">// Route works for any coords</span>
                        </div>
                        <div class="benefit-row">
                            <span class="benefit-key">organized:</span>
                            <span class="benefit-val">true</span>
                            <span class="benefit-comment">// Each class = one job</span>
                        </div>
                        <div class="benefit-row">
                            <span class="benefit-key">maintainable:</span>
                            <span class="benefit-val">true</span>
                            <span class="benefit-comment">// Change export? Edit Route only</span>
                        </div>
                        <div class="benefit-row">
                            <span class="benefit-key">scalable:</span>
                            <span class="benefit-val">true</span>
                            <span class="benefit-comment">// Easy to add Traffic, Weather</span>
                        </div>
                    </div>
                    <div class="code-box" style="margin-top: 28px; max-width: 500px;">
                        <span class="comment">// Result:</span><br>
                        OOP = <span class="string">"Clean"</span> + <span class="string">"Modular"</span> + <span class="string">"Professional"</span>
                    </div>
                </div>
            </div>
            
            <div class="oop-nav">
                <button id="oopPrev">‚Üê Previous</button>
                <div class="oop-dots" id="oopDots"></div>
                <button id="oopNext">Next ‚Üí</button>
            </div>
        </div>
    </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="app.js"></script>
</body>
</html>
